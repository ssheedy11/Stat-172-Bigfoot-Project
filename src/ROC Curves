#MEGA AUC CURVE
library(RColorBrewer)

forest_dRColorBrewerforest_data <- data.frame(
  Model = "Forest",
  Specificity = forest_rocCurve$specificities,
  Sensitivity = forest_rocCurve$sensitivities,
  AUC = forest_rocCurve$auc%>% as.numeric
)

# Combine all the data frames
roc_data <- rbind(mle_data, lasso_data, ridge_data,forest_data)

label_data <- roc_data %>% 
  group_by(Model) %>% 
  summarize(
    AUC = first(AUC),
    x = max(1 - Specificity),
    y = max(Sensitivity)
  ) %>% 
  ungroup() %>% 
  mutate(
    y = y + (row_number() * 0.08) - .5,       # vertical staggering
    x = x - .5                         # pull labels slightly left
  )

all_greens <- brewer.pal(9, "Greens")
dark_greens <- all_greens[5:9]

ggplot() +
  geom_line(
    aes(x = 1 - Specificity, y = Sensitivity, color = Model),
    data = roc_data
  ) +
  geom_text(
    data = label_data,
    aes(
      x = x,
      y = y,
      colour = Model,
      label = paste0(Model, " AUC = ", round(AUC, 3))
    ),
    hjust = -0.1
  ) +
  scale_color_manual(values = dark_greens) +
  labs(x = "1 - Specificity", y = "Sensitivity", color = "Model") +
  theme_minimal() +
  coord_cartesian(clip = "off")
